# Elixir application management for Aria Character Core\n# Copyright (c) 2025-present K. S. Ernest (iFire) Lee\n# SPDX-License-Identifier: MIT\n\nimport \"install.just\"\n\nstart-elixir-app: install-elixir-erlang-env\n    #!/usr/bin/env bash\n    echo \"ðŸš€ Starting Elixir application...\"\n    \n    # Setup asdf environment\n    export ASDF_DIR=\"$(pwd)/.asdf\"\n    export ASDF_DATA_DIR=\"$(pwd)/.asdf\"\n    export PATH=\"$(pwd)/.asdf/bin:$(pwd)/.asdf/shims:${PATH}\"\n    . ./.asdf/asdf.sh || true\n    \n    # Set environment variables for production\n    export MIX_ENV=prod\n    export PHX_SERVER=true\n    export DATABASE_URL=\"postgresql://root@localhost:26257/aria_character_core?sslmode=disable\"\n    export VAULT_ADDR=\"http://localhost:8200\"\n    \n    # Get dependencies and compile\n    echo \"ðŸ“¦ Getting dependencies...\"\n    mix deps.get --only prod\n    \n    echo \"ðŸ”¨ Compiling application...\"\n    mix compile\n    \n    # Run database migrations\n    echo \"ðŸ—„ï¸  Running database migrations...\"\n    mix ecto.create || true\n    mix ecto.migrate\n    \n    # Start the application in the background\n    echo \"ðŸš€ Starting Phoenix application...\"\n    nohup mix phx.server > aria_app.log 2>&1 &\n    \n    # Wait for the application to be ready\n    echo \"â³ Waiting for Aria App to be ready...\"\n    timeout 60s bash -c \'until curl -sf http://localhost:4000/health >/dev/null 2>&1; do echo \"Waiting...\"; sleep 2; done\' || (echo \"âŒ Aria App failed to start\" && exit 1)\n    \n    echo \"âœ… Elixir application started successfully!\"\n\nstop-elixir-app:\n    #!/usr/bin/env bash\n    echo \"ðŸ›‘ Stopping Elixir application...\"\n    pkill -f \"mix phx.server\" 2>/dev/null || true\n    echo \"âœ… Elixir application stopped\"\n\nelixir-app-status:\n    #!/usr/bin/env bash\n    echo \"ðŸ“Š Elixir Application Status:\"\n    echo \"Process: $(pgrep -f \'mix phx.server\' >/dev/null && echo \'âœ… RUNNING\' || echo \'âŒ STOPPED\')\"\n    echo \"Health: $(curl -sf http://localhost:4000/health >/dev/null 2>&1 && echo \'âœ… HEALTHY\' || echo \'âŒ UNHEALTHY\')\"\n    if curl -sf http://localhost:4000/health >/dev/null 2>&1; then\n        echo \"ðŸŒ Web UI: http://localhost:4000\"\n    fi\n\nelixir-app-logs:\n    #!/usr/bin/env bash\n    echo \"ðŸ“‹ Elixir Application Logs:\"\n    tail -30 aria_app.log 2>/dev/null || echo \"No Elixir app logs available\"
