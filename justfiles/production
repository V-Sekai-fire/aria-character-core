# Production deployment recipes for Aria Character Core
# Copyright (c) 2025-present K. S. Ernest (iFire) Lee
# SPDX-License-Identifier: MIT

import "install"
import "services"

setup-production:
    #!/usr/bin/env bash
    echo "ğŸš€ Setting up production environment with systemd services..."
    if [ "$EUID" -ne 0 ]; then
        echo "âŒ Please run with sudo for production setup"
        exit 1
    fi
    ./scripts/setup-production.sh

start-production:
    #!/usr/bin/env bash
    echo "ğŸš€ Starting all Aria services via systemd..."
    sudo systemctl start aria.target
    echo "âœ… All services started! Use 'just status-production' to check status"

stop-production:
    #!/usr/bin/env bash
    echo "ğŸ›‘ Stopping all Aria services via systemd..."
    sudo systemctl stop aria.target
    echo "âœ… All services stopped!"

status-production:
    #!/usr/bin/env bash
    echo "ğŸ“Š Checking production service status..."
    echo ""
    echo "=== Aria Stack Status ==="
    sudo systemctl status aria.target --no-pager -l
    echo ""
    echo "=== Individual Services ==="
    for service in aria-cockroachdb aria-openbao aria-seaweedfs aria-app; do
        echo "--- $service ---"
        sudo systemctl status $service.service --no-pager -l | head -10
        echo ""
    done

logs-production:
    #!/usr/bin/env bash
    echo "ğŸ“‹ Viewing Aria application logs..."
    sudo journalctl -u aria-app.service -f

logs-all-production:
    #!/usr/bin/env bash
    echo "ğŸ“‹ Viewing all Aria service logs..."
    sudo journalctl -u aria-cockroachdb.service -u aria-openbao.service -u aria-seaweedfs.service -u aria-app.service -f

restart-production:
    #!/usr/bin/env bash
    echo "ğŸ”„ Restarting all Aria services..."
    sudo systemctl restart aria.target
    echo "âœ… All services restarted!"

enable-production:
    #!/usr/bin/env bash
    echo "âš¡ Enabling services to start on boot..."
    sudo systemctl enable aria.target
    echo "âœ… Services will start automatically on boot"

disable-production:
    #!/usr/bin/env bash
    echo "âš¡ Disabling services from starting on boot..."
    sudo systemctl disable aria.target
    echo "âœ… Services will not start automatically on boot"
