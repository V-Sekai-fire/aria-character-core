# Production deployment recipes for Aria Character Core
# Copyright (c) 2025-present K. S. Ernest (iFire) Lee
# SPDX-License-Identifier: MIT

import "install"
import "services"

setup-production:
    #!/usr/bin/env bash
    echo "🚀 Setting up production environment with systemd services..."
    if [ "$EUID" -ne 0 ]; then
        echo "❌ Please run with sudo for production setup"
        exit 1
    fi
    ./scripts/setup-production.sh

start-production:
    #!/usr/bin/env bash
    echo "🚀 Starting all Aria services via systemd..."
    sudo systemctl start aria.target
    echo "✅ All services started! Use 'just status-production' to check status"

stop-production:
    #!/usr/bin/env bash
    echo "🛑 Stopping all Aria services via systemd..."
    sudo systemctl stop aria.target
    echo "✅ All services stopped!"

status-production:
    #!/usr/bin/env bash
    echo "📊 Checking production service status..."
    echo ""
    echo "=== Aria Stack Status ==="
    sudo systemctl status aria.target --no-pager -l
    echo ""
    echo "=== Individual Services ==="
    for service in aria-cockroachdb aria-openbao aria-seaweedfs aria-app; do
        echo "--- $service ---"
        sudo systemctl status $service.service --no-pager -l | head -10
        echo ""
    done

logs-production:
    #!/usr/bin/env bash
    echo "📋 Viewing Aria application logs..."
    sudo journalctl -u aria-app.service -f

logs-all-production:
    #!/usr/bin/env bash
    echo "📋 Viewing all Aria service logs..."
    sudo journalctl -u aria-cockroachdb.service -u aria-openbao.service -u aria-seaweedfs.service -u aria-app.service -f

restart-production:
    #!/usr/bin/env bash
    echo "🔄 Restarting all Aria services..."
    sudo systemctl restart aria.target
    echo "✅ All services restarted!"

enable-production:
    #!/usr/bin/env bash
    echo "⚡ Enabling services to start on boot..."
    sudo systemctl enable aria.target
    echo "✅ Services will start automatically on boot"

disable-production:
    #!/usr/bin/env bash
    echo "⚡ Disabling services from starting on boot..."
    sudo systemctl disable aria.target
    echo "✅ Services will not start automatically on boot"
